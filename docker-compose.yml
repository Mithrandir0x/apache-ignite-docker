
version: "3"

services:  

  nginx:
    image: nginx
    environment:
      - NGINX_HOST=nginx
      - NGINX_PORT=80
    ports:
      - 9090:80
    volumes:
      - ./static:/usr/share/nginx/html:ro
  
  zk:
    build: ./zookeeper
    ports:
      - 2181:2181
    environment:
      ZOOKEEPER_PORT: 2181
      ZOOKEEPER_VERSION: 3.4.11
    volumes:
      - ./.data/zookeeper:/opt/zookeeper-3.4.11/data
  
  data01:
    build: ./ignite
    ports:
      - 18081:8080
    depends_on:
      - nginx
      - zk
    environment:
      CONFIG_URI: http://nginx/zk-cache.xml

  data02:
    build: ./ignite
    ports:
      - 18082:8080
    depends_on:
      - nginx
      - zk
    environment:
      CONFIG_URI: http://nginx/zk-cache.xml
